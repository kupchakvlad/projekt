\doxysection{add\+\_\+product\+\_\+back.\+php}
\hypertarget{add__product__back_8php_source}{}\label{add__product__back_8php_source}\index{add\_product/add\_product\_back.php@{add\_product/add\_product\_back.php}}
\mbox{\hyperlink{add__product__back_8php}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00001}00001\ <?php}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00016}00016\ session\_start();}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00025}\mbox{\hyperlink{add__product__back_8php_a711797613cb863ca0756df789c396bf2}{00025}}\ \mbox{\hyperlink{add__product__back_8php_a711797613cb863ca0756df789c396bf2}{\$host}}\ =\ \textcolor{stringliteral}{"{}localhost"{}};}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00026}\mbox{\hyperlink{add__product__back_8php_a0eb82aa5f81cf845de4b36cd653c42cf}{00026}}\ \mbox{\hyperlink{add__product__back_8php_a0eb82aa5f81cf845de4b36cd653c42cf}{\$username}}\ =\ \textcolor{stringliteral}{"{}kupchvla"{}};}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00027}\mbox{\hyperlink{add__product__back_8php_a607686ef9f99ea7c42f4f3dd3dbb2b0d}{00027}}\ \mbox{\hyperlink{add__product__back_8php_a607686ef9f99ea7c42f4f3dd3dbb2b0d}{\$password}}\ =\ \textcolor{stringliteral}{"{}webove\ aplikace"{}};}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00028}\mbox{\hyperlink{add__product__back_8php_a7691c0162d89de0b6ba47edcd8ba8878}{00028}}\ \mbox{\hyperlink{add__product__back_8php_a7691c0162d89de0b6ba47edcd8ba8878}{\$database}}\ =\ \textcolor{stringliteral}{"{}kupchvla"{}};}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00034}\mbox{\hyperlink{add__product__back_8php_a0d9c79b9b86b3f5891c6d3892f12c6a0}{00034}}\ \mbox{\hyperlink{add__product__back_8php_a0d9c79b9b86b3f5891c6d3892f12c6a0}{\$connection}}\ =\ mysqli\_connect(\mbox{\hyperlink{add__product__back_8php_a711797613cb863ca0756df789c396bf2}{\$host}},\ \mbox{\hyperlink{add__product__back_8php_a0eb82aa5f81cf845de4b36cd653c42cf}{\$username}},\ \mbox{\hyperlink{add__product__back_8php_a607686ef9f99ea7c42f4f3dd3dbb2b0d}{\$password}},\ \mbox{\hyperlink{add__product__back_8php_a7691c0162d89de0b6ba47edcd8ba8878}{\$database}});}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00036}00036\ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{add__product__back_8php_a0d9c79b9b86b3f5891c6d3892f12c6a0}{\$connection}})\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00037}00037\ \ \ \ \ die(\textcolor{stringliteral}{"{}Connection\ failed:\ "{}}\ .\ mysqli\_connect\_error());}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00038}00038\ \}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00047}00047\ \textcolor{keywordflow}{if}\ (isset(\$\_POST[\textcolor{stringliteral}{"{}submit"{}}]))\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00053}00053\ \ \ \ \ \$upload\_directory\ =\ \textcolor{stringliteral}{"{}/home/kupchvla/www/projekt/photo/"{}};}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00054}00054\ \ \ \ \ \mbox{\hyperlink{admin__handling_8php_af0fcd925f00973e32f7214859dfb3c6b}{\$user\_id}}\ =\ \$\_SESSION[\textcolor{stringliteral}{"{}user\_id"{}}];}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00065}00065\ \ \ \ \ \$product\_name\ =\ trim(\$\_POST[\textcolor{stringliteral}{"{}product\_name"{}}]);}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00066}00066\ \ \ \ \ \$product\_fabric\ =\ trim(\$\_POST[\textcolor{stringliteral}{"{}product\_fabric"{}}]);}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00067}00067\ \ \ \ \ \$product\_season\ =\ trim(\$\_POST[\textcolor{stringliteral}{"{}season"{}}]);}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00068}00068\ \ \ \ \ \$product\_size\ =\ (int)\ trim(\$\_POST[\textcolor{stringliteral}{"{}product\_size"{}}]);}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00069}00069\ \ \ \ \ \$product\_price\ =\ trim(\$\_POST[\textcolor{stringliteral}{"{}product\_price"{}}]);}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00077}00077\ \ \ \ \ \$all\_file\_paths\ =\ [];}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00078}00078\ \ \ \ \ \mbox{\hyperlink{add__product_8php_a95ac5a5e9d6bfe4807b34cd1b783920e}{\$errors}}\ =\ [];}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00079}00079\ \ \ \ \ \textcolor{keywordflow}{if}\ (count(\$\_FILES[\textcolor{stringliteral}{"{}photo"{}}][\textcolor{stringliteral}{"{}name"{}}])\ ===\ 0\ ||\ \$\_FILES[\textcolor{stringliteral}{"{}photo"{}}][\textcolor{stringliteral}{"{}error"{}}][0]\ !=\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00080}00080\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{add__product_8php_a95ac5a5e9d6bfe4807b34cd1b783920e}{\$errors}}[\textcolor{stringliteral}{'photo'}]\ =\ \textcolor{stringliteral}{"{}At\ least\ one\ photo\ is\ required."{}};}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00081}00081\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00083}00083\ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$product\_price)\ ||\ !is\_numeric(\$product\_price)\ ||\ (\textcolor{keywordtype}{float})\$product\_price\ <=\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00084}00084\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{add__product_8php_a95ac5a5e9d6bfe4807b34cd1b783920e}{\$errors}}[\textcolor{stringliteral}{'price'}]\ =\ \textcolor{stringliteral}{"{}Valid\ price\ greater\ than\ 0\ is\ required."{}};}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00085}00085\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00087}00087\ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$product\_name))\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00088}00088\ \ \ \ \ \mbox{\hyperlink{add__product_8php_a95ac5a5e9d6bfe4807b34cd1b783920e}{\$errors}}[\textcolor{stringliteral}{'name'}]\ =\ \textcolor{stringliteral}{"{}Product\ name\ is\ required."{}};}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00089}00089\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00094}00094\ \ \ \ \ \textcolor{keywordflow}{if}\ (!empty(\mbox{\hyperlink{add__product_8php_a95ac5a5e9d6bfe4807b34cd1b783920e}{\$errors}}))\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00095}00095\ \ \ \ \ \ \ \ \ \$\_SESSION[\textcolor{stringliteral}{'add\_product\_errors'}]\ =\ \mbox{\hyperlink{add__product_8php_a95ac5a5e9d6bfe4807b34cd1b783920e}{\$errors}};}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00096}00096\ \ \ \ \ \ \ \ \ \$\_SESSION[\textcolor{stringliteral}{'add\_product\_data'}]\ =\ [}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'product\_name'}\ =>\ \$product\_name,}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'product\_fabric'}\ =>\ \$product\_fabric,}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'product\_season'}\ =>\ \$product\_season,}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'product\_size'}\ =>\ \$product\_size,}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'product\_price'}\ =>\ \$product\_price}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00102}00102\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00103}00103\ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{"{}Location:\ add\_product.php"{}});}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00104}00104\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logOut_8php_a6733eb5f605d09eaede9845835d71c4e}{exit}};}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00105}00105\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00111}00111\ \ \ \ \ \textcolor{keywordflow}{for}\ (\$i\ =\ 0;\ \$i\ <\ count(\$\_FILES[\textcolor{stringliteral}{"{}photo"{}}][\textcolor{stringliteral}{"{}name"{}}]);\ \$i++)\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00112}00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$\_FILES[\textcolor{stringliteral}{"{}photo"{}}][\textcolor{stringliteral}{"{}error"{}}][\$i]\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ \$file\_name\ =\ time()\ .\ \textcolor{stringliteral}{"{}\_"{}}\ .\ \$i\ .\ \textcolor{stringliteral}{"{}\_"{}}\ .\ basename(\$\_FILES[\textcolor{stringliteral}{"{}photo"{}}][\textcolor{stringliteral}{"{}name"{}}][\$i]);}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \$file\_tmp\ =\ \$\_FILES[\textcolor{stringliteral}{"{}photo"{}}][\textcolor{stringliteral}{"{}tmp\_name"{}}][\$i];}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ \$file\_path\ =\ \$upload\_directory\ .\ \$file\_name;}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (move\_uploaded\_file(\$file\_tmp,\ \$file\_path))\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$all\_file\_paths[]\ =\ \$file\_path;}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00120}00120\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00121}00121\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00127}00127\ \ \ \ \ \$final\_file\_paths\ =\ implode(\textcolor{charliteral}{','},\ \$all\_file\_paths);}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00128}00128\ \ \ \ \ \$product\_price\ =\ (float)\ \$product\_price;}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00137}00137\ \ \ \ \ \$insert\_product\_query\ =\ \textcolor{stringliteral}{"{}INSERT\ INTO\ products\ (}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00138}00138\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ user\_id,\ file\_path,\ name,\ fabric,\ season,\ size,\ price}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00139}00139\ \textcolor{stringliteral}{\ \ \ \ )\ VALUES\ (?,\ ?,\ ?,\ ?,\ ?,\ ?,\ ?)"{}};}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00141}00141\ \ \ \ \ \mbox{\hyperlink{admin__handling_8php_af27a9140d5f2658693e7fd107f716449}{\$stmt}}\ =\ mysqli\_prepare(\mbox{\hyperlink{add__product__back_8php_a0d9c79b9b86b3f5891c6d3892f12c6a0}{\$connection}},\ \$insert\_product\_query);}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00143}00143\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00144}00144\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{admin__handling_8php_af27a9140d5f2658693e7fd107f716449}{\$stmt}})\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00145}00145\ \ \ \ \ \ \ \ \ mysqli\_stmt\_bind\_param(\mbox{\hyperlink{admin__handling_8php_af27a9140d5f2658693e7fd107f716449}{\$stmt}},\ \textcolor{stringliteral}{"{}issssii"{}},\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00146}00146\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{admin__handling_8php_af0fcd925f00973e32f7214859dfb3c6b}{\$user\_id}},\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00147}00147\ \ \ \ \ \ \ \ \ \$final\_file\_paths,}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00148}00148\ \ \ \ \ \ \ \ \ \$product\_name,\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00149}00149\ \ \ \ \ \ \ \ \ \$product\_fabric,\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00150}00150\ \ \ \ \ \ \ \ \ \$product\_season,\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00151}00151\ \ \ \ \ \ \ \ \ \$product\_size,\ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00152}00152\ \ \ \ \ \ \ \ \ \$product\_price}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00153}00153\ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00154}00154\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00159}00159\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mysqli\_stmt\_execute(\mbox{\hyperlink{admin__handling_8php_af27a9140d5f2658693e7fd107f716449}{\$stmt}}))\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{"{}Location:\ ../main/main.php"{}});}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logOut_8php_a6733eb5f605d09eaede9845835d71c4e}{exit}};}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00162}00162\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ die(\textcolor{stringliteral}{"{}Execution\ failed:\ "{}}\ .\ mysqli\_stmt\_error(\mbox{\hyperlink{admin__handling_8php_af27a9140d5f2658693e7fd107f716449}{\$stmt}}));}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00164}00164\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00165}00165\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00166}00166\ \ \ \ \ \ \ \ \ die(\textcolor{stringliteral}{"{}Statement\ preparation\ failed."{}});}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00167}00167\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00168}00168\ \}}
\DoxyCodeLine{\Hypertarget{add__product__back_8php_source_l00169}00169\ ?>}

\end{DoxyCode}
